{
	"info": {
		"_postman_id": "markt-chats-collection",
		"name": "Markt - Chat Endpoints",
		"description": "Complete collection for testing all chat-related endpoints in the Markt API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Chat Rooms",
			"item": [
				{
					"name": "Get User Chat Rooms",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms?page=1&per_page=20",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Page number (default: 1)"
								},
								{
									"key": "per_page",
									"value": "20",
									"description": "Items per page (default: 20)"
								}
							]
						},
						"description": "Get paginated list of chat rooms for the authenticated user"
					},
					"response": []
				},
				{
					"name": "Create Chat Room (Buyer)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"seller_id\": \"{{seller_id}}\",\n  \"product_id\": \"{{product_id}}\",\n  \"request_id\": null\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms"
							]
						},
						"description": "Create or get existing chat room. If current user is buyer, provide seller_id. If seller, provide buyer_id."
					},
					"response": []
				},
				{
					"name": "Create Chat Room (Seller)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"buyer_id\": \"{{buyer_id}}\",\n  \"product_id\": \"{{product_id}}\",\n  \"request_id\": null\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms"
							]
						},
						"description": "Create or get existing chat room as seller"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing chat rooms"
		},
		{
			"name": "Chat Messages",
			"item": [
				{
					"name": "Get Room Messages",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/messages?page=1&per_page=50",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"messages"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Page number (default: 1)"
								},
								{
									"key": "per_page",
									"value": "50",
									"description": "Items per page (default: 50)"
								}
							]
						},
						"description": "Get paginated messages for a specific chat room"
					},
					"response": []
				},
				{
					"name": "Send Text Message",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"content\": \"Hello! Is this item still available?\",\n  \"message_type\": \"text\",\n  \"message_data\": null\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/messages",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"messages"
							]
						},
						"description": "Send a text message in a chat room"
					},
					"response": []
				},
				{
					"name": "Send Image Message",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"content\": \"Check out this image\",\n  \"message_type\": \"image\",\n  \"message_data\": {\n    \"image_url\": \"https://example.com/image.jpg\",\n    \"thumbnail_url\": \"https://example.com/thumb.jpg\"\n  }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/messages",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"messages"
							]
						},
						"description": "Send an image message in a chat room"
					},
					"response": []
				},
				{
					"name": "Send Product Message",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"content\": \"Take a look at this product\",\n  \"message_type\": \"product\",\n  \"message_data\": {\n    \"product_id\": \"PROD_12345678\"\n  }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/messages",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"messages"
							]
						},
						"description": "Send a product message in a chat room"
					},
					"response": []
				},
				{
					"name": "Mark Messages as Read",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/read",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"read"
							]
						},
						"description": "Mark all messages in a chat room as read for the current user"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing chat messages"
		},
		{
			"name": "Chat Offers",
			"item": [
				{
					"name": "Send Offer",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"product_id\": \"{{product_id}}\",\n  \"price\": 15000.00,\n  \"message\": \"I can offer you this price. What do you think?\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/offers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"offers"
							]
						},
						"description": "Send an offer message in a chat room"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing offers in chat"
		},
		{
			"name": "Message Reactions",
			"item": [
				{
					"name": "Get Message Reactions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/messages/{{message_id}}/reactions",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"messages",
								"{{message_id}}",
								"reactions"
							]
						},
						"description": "Get all reactions for a specific message (does not require authentication)"
					},
					"response": []
				},
				{
					"name": "Add Reaction",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reaction_type\": \"like\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/messages/{{message_id}}/reactions",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"messages",
								"{{message_id}}",
								"reactions"
							]
						},
						"description": "Add a reaction to a message. Reaction types: like, love, laugh, angry, sad, wow"
					},
					"response": []
				},
				{
					"name": "Remove Reaction",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/messages/{{message_id}}/reactions/{{reaction_type}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"messages",
								"{{message_id}}",
								"reactions",
								"{{reaction_type}}"
							]
						},
						"description": "Remove a specific reaction from a message"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing message reactions"
		},
		{
			"name": "Discounts",
			"item": [
				{
					"name": "Get Room Discounts",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/discounts",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"discounts"
							]
						},
						"description": "Get active discount offers for a chat room"
					},
					"response": []
				},
				{
					"name": "Create Discount Offer",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"discount_type\": \"percentage\",\n  \"discount_value\": 15.0,\n  \"minimum_order_amount\": 5000.00,\n  \"maximum_discount_amount\": 2000.00,\n  \"expires_at\": \"2024-12-31T23:59:59Z\",\n  \"usage_limit\": 1,\n  \"product_id\": \"{{product_id}}\",\n  \"discount_message\": \"Special discount just for you!\",\n  \"discount_code\": \"SPECIAL15\",\n  \"metadata\": {\n    \"reason\": \"New customer offer\"\n  }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/discounts",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"discounts"
							]
						},
						"description": "Create a new discount offer in a chat room (seller only). discount_type: 'percentage' or 'fixed_amount'"
					},
					"response": []
				},
				{
					"name": "Create Fixed Amount Discount",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"discount_type\": \"fixed_amount\",\n  \"discount_value\": 1000.00,\n  \"minimum_order_amount\": 5000.00,\n  \"maximum_discount_amount\": 1000.00,\n  \"expires_at\": \"2024-12-31T23:59:59Z\",\n  \"usage_limit\": 1,\n  \"product_id\": \"{{product_id}}\",\n  \"discount_message\": \"Get â‚¦1000 off your order!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/rooms/{{room_id}}/discounts",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"rooms",
								"{{room_id}}",
								"discounts"
							]
						},
						"description": "Create a fixed amount discount offer"
					},
					"response": []
				},
				{
					"name": "Respond to Discount",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"response\": \"accepted\",\n  \"response_message\": \"Thank you! I'll use this discount for my order.\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/discounts/{{discount_id}}/respond",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"discounts",
								"{{discount_id}}",
								"respond"
							]
						},
						"description": "Respond to a discount offer (buyer only). Response: 'accepted' or 'rejected'"
					},
					"response": []
				},
				{
					"name": "Apply Discount to Order",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"order_amount\": 10000.00\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/chats/discounts/{{discount_id}}/apply",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"discounts",
								"{{discount_id}}",
								"apply"
							]
						},
						"description": "Apply a discount to an order (validate and calculate discount amount)"
					},
					"response": []
				},
				{
					"name": "Cancel Discount",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/discounts/{{discount_id}}/cancel",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"discounts",
								"{{discount_id}}",
								"cancel"
							]
						},
						"description": "Cancel a discount offer (seller only)"
					},
					"response": []
				},
				{
					"name": "Get My Active Discounts",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/chats/discounts/my-active",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"chats",
								"discounts",
								"my-active"
							]
						},
						"description": "Get all active discount offers for the current user"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing discount offers in chat"
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "room_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "message_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "discount_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "seller_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "buyer_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "product_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "reaction_type",
			"value": "like",
			"type": "string"
		}
	]
}
